# 템플릿 엔진

## 목차
1. [템플릿 엔진](#1-템플릿-엔진)       
1-1. [템플릿 엔진이란?](#1-1-템플릿-엔진이란)    
1-2. [서버 사이드 vs 클라이언트 사이드](#1-2-서버-사이드-vs-클라이언트-사이드)    
1-3. [Reference](#1-3-reference)  
2. [Mustache](#2-mustache)  
2-1. [Mustache?](#2-1-mustache)  
2-2. [문법](#2-2-문법)  
2-3. [Reference](#2-3-reference)  
***

### 1. 템플릿 엔진
  - #### 1-1. 템플릿 엔진이란?
    - 지정된 템플릿 양식과 데이터가 합쳐져 HTML 문서를 출력하는 소프트웨어(또는 소프트웨어 컴포넌트)

    - 템플릿 엔진이 나오게 된 이유
      ```
      웹 - 서버, 클라이언트(브라우저) 존재
      
      1. 기존 방식 - 서버에서 DB의 데이터를 가져 온 뒤 HTML로 만들어 클라이언트에게 보내줌
      
      2. 이슈 발생 - 페이지의 일부만 변경시에도 전체 페이지를 다시 그려야함 즉, 비효율적

      3. 대안 - Ajax를 사용하여 프론트엔드단(화면)에서 필요한 데이터 부분만 재가공
      
      4. 이슈 발생 - 데이터 가공시 손이 많이감(페이지가 보이지 않거나, 이상하게 나오는 경우)
      
      5. 대안 - 쉬운 표현으로 서버에서 받아온 데이터를 효과적으로 보여줄 중간매체를 원한다. 
      
      6. 결과 - 템플릿 엔진   
      ```
    
    - 템플릿 엔진 사용 이유
      ```
      1. 많은 코드를 줄일 수 있다. (기존 HTML에 비해 간단한 문법)
      
      2. 재사용성이 높음(템플릿 엔진 문법으로 디자인을 만들고 데이터만 바꿔 렌더링 하면 됨)
      
      3. 유지보수에 용이(동일한 템플릿 사용시 넘겨주는 데이터만 수정하면 되므로)
      ```
    
  - #### 1-2. 서버 사이드 vs 클라이언트 사이드
    - 서버 사이드 템플릿 엔진
      - JSP, Freemarker  
        참고! - JSP는 명확하게 서버 템플릿 엔진은 아니지만, view 역할만 하도록 구성시에는 템플릿 엔진으로 사용가능 (Spring + JSP)  
        
      - 서버에서 구동됨      
      
      - 수행 과정
        ```
        1. 사용자가 요청
        
        2. 브라우저는 사용자의 요청을 받아 서버에 요청을 전달
        
        3. 서버에서 템플릿 양식에 Java 코드로 문자열을 만듦 (서버 사이드 렌더링 - SSR)
        
        4. 이 문자열을 HTML로 변환하여 브라우저로 전달
        
        5. 브라우저는 전달 받은 것을 화면에 표시만 함
        ```
        
    - 클라이언트 사이드 템플릿 엔진
      - react, Vue.js  
        참고! SPA(Singleton Page Application)은 클라이언트 사이드 렌더일에 의해 구현됨  
      
      - 브라우저 위에서 작동

      - 수행 과정
        ```
        1. 사용자가 요청
        
        2. 브라우저는 사용자의 요청을 받아 서버에 전달
        
        3. 서버는 JSON or xml 형식으로 데이터만 전달

        4. 브라우저는 템플릿 양식에 데이터를 조립하여 HTML을 만듦 (클라이언트 사이드 렌더링 - CSR)
        
        5. 이를 화면에 표시
        ```
  - #### 1-3. Reference
    - [깜비의 끄적끄적 템플릿 엔진 / SSR & CSR](https://kkambi.tistory.com/40)  
    - 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 - 이동욱 저  
  
### 2. Mustache
  - #### 2-1. Mustache?
    - Ruby, JS, Python, Java 등 대부분의 언어를 지원하는 심플한 템플릿 엔진

    - Java에서 사용될 땐 서버 템플릿 엔진, JS에서 사용될 땐 클라이언트 템플릿 엔진으로 사용 가능

    - 제일 큰 장점 =  Thymeleaf(Spring 권장)나 JSP와 달리 커뮤니티 버전에서도 플러그인 사용 가능!

  - #### 2-2. 문법
     - 변수
       ```
       데이터
       {
          "name" : "ABBO",
          "company" : "<b>Tistory</b>"
       }
       
       템플릿에서 사용시
       {{name}} - 이스케이프 된 HTML 언어 표시
       {{birth}} - 해당 변수는 없으므로 아무런 값도 표시 되지 않음
       {{company}} - 이스케이프 된 HTML 언어 표시
       {{{company}}} - 이스케이프 되지 않은 문자열 표시
       
       결과
       ABBO
       
       &lt;b&gt;Tistory&lt;/b&gt
       <b>Tistory</b>
       ```  
       
     - 파일 가져오기  
       ![image](https://user-images.githubusercontent.com/65080004/114388861-397d9880-9bcf-11eb-965b-708465d1ce51.png)  
       
       ```
       템플릿에서 사용시
       {{>layout/header}} - 현재 머스테치 파일(index.mustache)을 기준으로 다른 파일을 가져옴
       ```  
     
     - 반복문 - 변수가 배열일 경우 
       ```
       데이터 
       {
          "user" : [
           { "name" : "Mike" },
           { "name" : "Alsa" },
           { "name" : "Silly" }
         ]
       }
       
       템플릿에서 사용시
       {{#user}} - user라는 List를 순회, 자바의 for문과 동일 / 변수의 값이 배열로 되어 있기 때문에 반복문이 됨
           {{name}} - List에서 뽑아낸 객체의 필드 사용
       {{/user}}

       결과
       Mike
       Alsa
       silly
       ```
       
     - 조건문 - 변수가 배열이 아닐 경우, 단 0이나 false, 빈 문자열은 거짓으로 평가되므로 내용 출력 되지 않음
       ```
       데이터 
       {
          "sessionUser" : ABBO
       }
       
       템플릿에서 사용시
       {{#sessionUser}} - sessionUser가 존재할 경우 로그아웃 링크 a태그 표시
          <a href="/users/logout" class="navbar-brand">로그아웃</a>
       {{/sessionUser}}
       {{^sessionUser}} - sessionUser가 존재하지 않을 경우 로그인 링크 a태그 표시
          <a href="/users/loginForm" class="navbar-brand">로그인</a>
       {{/sessionUser}}
       

       결과
       
       객체 o
       로그아웃
       
       객체 x
       로그인
       ```
       
  - #### 2-3. Reference
    - 스프링 부트와 AWS로 혼자 구현하는 웹 서비스 - 이동욱 저  
    - [ABBO Mustache 템플릿 문법 알아보기](https://abbo.tistory.com/5)  
