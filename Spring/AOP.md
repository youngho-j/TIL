# Spring AOP 개념 이해하기
## 목차
1. [AOP](#1-aop)     
1-1. [AOP란?](#1-1-aop란)    
1-2. [등장배경](#1-2-등장배경)  
1-3. [AOP와 OOP](#1-3-aop와-oop)  
1-4. [용어](#1-4-용어)  
***
### 1. AOP
  - #### 1-1. AOP란?
    - Aspect Oriented Programming
    
    - 관점(관심) 지향 프로그래밍 쉽게 말한다면, 프로젝트 구조를 `바라보는 관점을 바꿔서 보는 것`  
      이를 통해 `추출한 공통된 기능을 재사용하는 기법`  
      정리한다면, 어플리케이션의 핵심적인 기능에서 부가적인 기능을 분리해서 애스팩트라는 독특한 모듈로 만들어서 설계하고 개발하는 방법  
    
    - 예를 들어 은행이라는 프로그램에 이체, 대출승인, 이자계산 3가지의 서비스가 존재한다고 가정한 뒤 생각해보면,  
      은행의 각 서비스의 핵심기능에는 계좌이체, 대출승인, 이자계산 기능이 존재하며,   
      각자 자신만의 코드를 구현하고 있음을 볼 수 있음  
      
      ![image](https://user-images.githubusercontent.com/65080004/118761333-31400980-b8af-11eb-849d-3c07c93cfd05.png)  
    
    - 이 관점을 핵심기능에서 보는게 아닌 부가기능적인 관점에서 바라본다면 아래 그림과 같이 볼 수 있으며,  
      로깅, 보안, 트랜잭션 기능이 공통되는 것을 알 수 있음
      
      ![image](https://user-images.githubusercontent.com/65080004/118762052-84668c00-b8b0-11eb-9853-da5f5496a9d0.png)  

    - 즉, AOP는 기존 OOP에서 `바라보던 관점을 다르게 하여 공통된 요소를 추출` 하자는 것  
      이때, 가로(횡) 영역의 공통된 부분을 잘라냈다고 하여 크로스 컷팅(Cross_Cutting)이라고 부르기도 함  
  
  - #### 1-2. 등장배경  
    - OOP에서 공통된 기능을 재사용하는 방법으로 상속, 위임을 사용  
    - 전체 어플리케이션에서 여기저기에서 사용되는 부가기능들을 상속, 위임으로 처리하려고하면 깔끔한 모듈화 어려움  
    - 즉, 해당 문제(관심사의 분리(핵심기능과 부가기능의 분리))를 해결하기 위해  
      공통된 기능(부가기능)을 재사용하는 기법인 AOP 개념 등장   
  
  - #### 1-3. AOP와 OOP
    - OOP : `비즈니스 로직의 모듈화` 
      - 모듈화의 핵심 단위는 비즈니스 로직  
    
    - AOP : `인프라 혹은 부가기능의 모듈화`  
      - 각각의 모듈들의 주 목적 외에 필요한 부가적인 기능들  
      - 예 : 로깅, 트랜잭션, 보안 등  
      - 장점  
        1. 어플리케이션 전체에 흩어진 공통 기능이 하나의 장소에서 관리됨  
        2. 다른 서비스 모듈들이 본인의 목적에만 충실하고 그 외 사항들은 신경쓰지 않아도 됨  
     
  - #### 1-4. 용어
    - 타켓(Target)  
      - 부가기능을 부여할 대상(핵심 기능담당)  
    
    - 애스펙트(Aspect)
      - 부가기능 모듈, 핵심기능에 부가되어 의미를 갖는 특별한 모듈  
      - 부가될 기능을 정의한 `어드바이스` + 어드바이스를 어디에 적용할지 결정하는 `포인트 컷`  
    
    - 어드바이스(Advice)  
      - 실질적으로 부가기능을 담은 구현체
      - 어드바이스의 경우 타겟 오브젝트에 종속되지 않기 때문에 순수하게 부가기능에만 집중할 수 있음
      - 어드바이스는 애스펙트가 '무엇'을 '언제' 할지를 정의
    
    - 포인트컷(PointCut)
      - 부가기능이 `적용될 대상(메소드)를 선정하는 방법`  
      - 즉, 어드바이스를 적용할 조인포인트를 선별하는 기능을 정의한 모듈  
    
    - 조인포인트(JoinPoint)
      - 어드바이스가 적용될 수 있는 `위치`
      - 다른 AOP 프레임워크와 달리 Spring에서는 메소드 조인포인트만 제공  
        (그래서 여러 책이나 문서에서 조인포인트에 대해 생략하기도 합니다. 무조건 메소드 단위로만 지정하기 때문)  
      - 따라서 Spring 프레임워크 내에서 조인포인트라 하면 메소드를 가리킨다고 생각해도됨
    
    - 프록시(Proxy)
      - 타겟을 감싸서 타겟의 요청을 대신 받아주는 랩핑(Wrapping) 오브젝트  
      - 구성   
        1. 호출자 (클라이언트)에서 타겟을 호출   
        2. 타겟이 아닌 타겟을 감싸고 있는 프록시가 호출  
        3. 프록시는 호출을 가로챈 후 타겟 메소드 실행전에 선처리, 타겟 메소드 실행 후 후처리를 실행  

    - 인트로덕션(Introduction)  
      - 타겟 클래스에 코드 변경없이 신규 메소드나 멤버변수를 추가하는 기능
    
    - 위빙(Weaving)
      - 지정된 객체에 애스팩트를 적용해서 새로운 프록시 객체를 생성하는 과정
      - 예시  
        예를 들면 A라는 객체에 트랜잭션 애스팩트가 지정되어 있다면, A라는 객체가 실행되기전 커넥션을 오픈하고  
        실행이 끝나면 커넥션을 종료하는 기능이 추가된 프록시 객체가 생성되고,  
        이 프록시 객체가 앞으로 A 객체가 호출되는 시점에서 사용됨   
        이때의 프록시객체가 생성되는 과정을 위빙이라 생각하면 됨  
      - 컴파일 타임, 클래스로드 타임, 런타임과 같은 시점에서 실행되지만, Spring AOP는 런타임에서 프록시 객체가 생성  
     
## Reference
 - [effortDev SpringAOP 내용정리](https://shlee0882.tistory.com/206)    
 - [기억보단 기록을 AOP 정리](https://jojoldu.tistory.com/71?category=635883)  
***
[목록으로](https://github.com/youngho-j/TIL/edit/main/Spring/README.md)
