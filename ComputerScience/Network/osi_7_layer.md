# OSI 7 계층

## 목차
1. [OSI 7 계층이란?](#1-osi-7-계층이란)    
1-1. [계층이 나눠진 이유?](#1-1-계층이-나눠진-이유)  
1-2. [OSI 계층 이미지](#1-2-osi-계층-이미지)  
2. [단계별로 살펴보는 OSI 7 계층](#2-단계별로-살펴보는-osi-7-계층)  
2-1. [물리계층(Physical Layer)](#2-1-물리계층physical-layer)  
2-1-1. [두대의 컴퓨터가 통신하기 위해서는 어떻게 해야하는가?](#2-1-1-두대의-컴퓨터가-통신하기-위해서는-어떻게-해야하는가)  
2-1-2. [인코딩/디코딩](#2-1-2-인코딩디코딩)  
2-1-3. [기술 구현 위치](#2-1-3-기술-구현-위치)   
2-1-4. [하드웨어 장비의 예](#2-1-4-하드웨어-장비의-예)  
2-1-5. [정리](#2-1-5-정리)  
2-2. [데이터링크 계층(DataLink Layer)](#2-2-데이터링크-계층datalink-layer)  
2-2-1. [여러대의 컴퓨터가 통신하기 위해서는 어떻게 해야하는가?](#2-2-1-여러대의-컴퓨터가-통신하기-위해서는-어떻게-해야하는가)  
2-2-2. [여러대의 컴퓨터가 통신하려면?](#2-2-2-여러대의-컴퓨터가-통신하려면)  
2-2-3. [인코딩/디코딩](#2-2-3-인코딩디코딩)  
2-2-4. [기술 구현 위치](#2-2-4-기술-구현-위치)   
2-2-5. [하드웨어 장비의 예](#2-2-5-하드웨어-장비의-예)  
2-2-6. [정리](#2-2-6-정리)  
2-3. [네트워크 계층(Network Layer)](#2-3-네트워크-계층network-layer)  
2-3-1. [더 많은 컴퓨터들 사이의 통신](#2-3-1-더-많은-컴퓨터들-사이의-통신)    
2-3-2. [인코딩/디코딩](#2-3-2-인코딩디코딩)  
2-3-3. [기술 구현 위치](#2-3-3-기술-구현-위치)  
2-3-4. [장비의 예](2-3-4-장비의-예)  
2-3-5. [정리](#2-3-5-정리)  
3. [Reference](#3-reference)  
***
### 1. OSI 7 계층이란? 
  - #### 1-1. 계층이 나눠진 이유?
    - `통신이 일어나는 과정을 단계별로 알 수 있기 때문`이다.
    - 통신이 일어나는 과정을 단계별로 알 수 있으므로 `흐름을 알아보기 쉽고, 문제 발생 시 해당 단계만 수정`을 하면 된다.
  
  - #### 1-2. OSI 계층 이미지
    ![image](https://user-images.githubusercontent.com/65080004/116046815-64c3b580-a6ae-11eb-9767-0b153b434f9c.png)

### 2. 단계별로 살펴보는 OSI 7 계층
  - #### 2-1. 물리계층(Physical Layer)
    - ##### 2-1-1. 두대의 컴퓨터가 통신하기 위해서는 어떻게 해야하는가?
      - 모든 파일, 프로그램은 0과 1의 나열로 이루어져 있다.  
      - 그렇다면? 0과 1을 주고 받을 수 있도록 하면 된다. 
      - 0과 1을 전송하기 위해 두 대의 컴퓨터 사이에 전선을 연결한다. 
      - 주파수를 `아날로그 신호로 변환`(Encoding)하여 전선으로 내보낸다.
      - 수신측에서 `아날로그 신호를 받아 0과 1의 나열로 해석`(Decoding) 한뒤 해당 데이터를 받을 수 있게된다. 
      - 즉, Physical Layer란 `물리적으로 연결된 두 대의 컴퓨터가 0과 1의 나열을 주고받을 수 있게 해주는 모듈`이다.
    
    - ##### 2-1-2. 인코딩/디코딩
      - 인코딩 : 원본을 변조를 시켜주는 것
      - 디코딩 : 변조된 것을 원본으로 해석해주는 것 
      - 과정
        ```
        1. 데이터 송신 컴퓨터에서 0101 0101 이라는 데이터를 보내려함
        
        2. Physical Layer encoder에서 아날로그 신호로 변환
        
        3. 이어진 전선을 통해 아날로그 신호가 수신 컴퓨터로 전달
        
        4. 데이터 수신 컴퓨터는 받은 아날로그 신호를 Physical Layer decoder에서 해석
        
        5. 수신 컴퓨터는 원본 데이터를 전달 받음
        ```
        
    - ##### 2-1-3. 기술 구현 위치 
      - PHY칩
      - 하드웨어적으로 구현되어있음
    
    - ##### 2-1-4. 하드웨어 장비의 예
      - 리피터(중계기) 
      - 허브
      - 케이블 등
    
    - ##### 2-1-5. 정리
      - 물리적으로 연결된 두 대의 컴퓨터가 0과 1의 나열을 주고받을 수 있게 해주는 모듈
      
      - 데이터를 `전기적인 신호로 변환하여 주고 받는 기능`만 함  
        전송 or 받는 데이터가 무엇인지, 어떤 에러가 있는지 등은 전혀 신경 쓰지 않음  
      
      - 전송 단위는 `비트`   
        

  - #### 2-2. 데이터링크 계층(DataLink Layer)
    - ##### 2-2-1. 여러대의 컴퓨터가 통신하기 위해서는 어떻게 해야하는가?
      1. 하나의 네트워크의 경우 
      - 현재 송신 컴퓨터와 수신 컴퓨터1가 케이블로 연결되어 있다. 
      - 현재 송신 컴퓨터에서 다른 수신 컴퓨터2로 데이터를 보내고 싶을 경우 케이블을 추가적으로 연결해줘야한다.
      - 그런데 케이블을 연결할 수 있는 포트는 한정적이므로, 포트 갯수 이상의 수신 컴퓨터에는 보낼 수 없다.  
        즉, 해당 방식은 포트와 케이블이 많이 필요하므로, `통신하고자하는 컴퓨터가 많아질수록 비용측면에서 비효율적`   
      
      - 이러한 단점을 해결하기 위해 다른 방법을 모색해야한다. 
      - 아래 그림과 같이 긴 케이블 선 중간마다 케이블을 엮어 컴퓨터 포트에 꽂는다.  
        ![image](https://user-images.githubusercontent.com/65080004/116079578-ef1e1080-a6d2-11eb-8688-eccfa2ff5724.png)  
      - 보내고 싶은 데이터를 보내게 되면 긴 케이블을 따라 연결된 모든 컴퓨터에게 데이터가 전달된다.  
      
      - 여기에서 긴 케이블을 상자안에 넣어둔다면 해당 상자는 `더미허브`가 된다. (용어는 이런게 있구나 정도만 알아두면됨)  
      
      - 현재 모든 컴퓨터가 연결되어 있으므로 데이터를 주고 받을 수 있다. 하나의 네트워크(인트라넷)을 이뤘다고 할 수 있음  
        하지만, `원하는 컴퓨터에게만 따로 데이터를 줄 수 없는 상황`이다.   
      - 이러한 점을 해결하기 위해 상자가 목적지를 확인해서 원하는 수신 컴퓨터에만 줄 수 있다면?
      - 이러한 기능을 가진 상자를 `스위치`라고 한다.  
        
        스위치 작동 흐름  
        ```
        1. 전송받은 프레임의 목적지를 확인(스위치 테이블 or 맥 어드레스 테이블)
        2. 테이블에 목적지 존재시 해당 경로로 보냄
        3. 없을 경우 모든 포트에 프레임 전송
        4. 목적지에 프레임 도착시 목적지의 장치가 자신의 맥 어드레스를 테이블로 전송
        5. 출발지의 테이블에서 목적지 장치의 맥 어드레스를 테이블에 저장
        6. 같은 목적지가 나올경우 테이블 참고하여 프레임 전송  
        ```
        
      2. 서로 다른 네트워크의 경우
      - 현재 서도 다른 네트워크가 존재하고, 서로 연결이 되어 있지 않아 통신을 할 수 없다.
      - 그렇다면, 두 네트워크가 통신을 하기위해서는 어떻게 해야할까?
      - `라우터`가 필요하다.  
        라우터란? `스위치와 스위치를 연결`해서 서로 다른 네트워크에 속한 컴퓨터끼리 통신이 가능하게 해주는 장비  
    
    - ##### 2-2-2. 여러대의 컴퓨터가 통신하려면?
      - 여러대의 컴퓨터가 하나의 스위치에 연결되어 있음
      - 여러대의 컴퓨터가 하나의 수신 컴퓨터에 동시에 데이터를 보냄
      - 데이터를 어떻게 끊어 읽느냐에 따라서 데이터가 달라질 수 있음
      - 그렇다면, 제대로 끊어 읽으려면 어떻게 해야하는가?
      - 이를 위해 송신 컴퓨터는 데이터의 앞 뒤에 특정한 비트열(MAC 주소 + a)을 붙여서 보냄
      - 수신 컴퓨터는 특정 비트열을 찾아 해석한뒤 데이터를 어느 컴퓨터가 보냈고 어떤 내용인지를 알 수 있음
    
    - ##### 2-2-3. 인코딩/디코딩
      - 과정
        ```
        1. 데이터를 송신하려는 컴퓨터에서 데이터를 수신 컴퓨터로 보내려함
        
        2. 데이터 링크 계층 인코더에서 데이터가 Framing 되어 나옴
        
        3. Framing이 된 데이터는 물리 계층 인코더에서 아날로그 신호로 변환
        
        4. 수신측 컴퓨터에 도착하여 물리 계층 디코더에서 해석되어 Framing된 데이터로 변환
        
        5. Framing된 데이터는 데이터 링크 계층 디코더에서 해석되어 데이터화 됨
        ```
        
    - ##### 2-2-4. 기술 구현 위치
      - 랜카드
      - 하드웨어 적으로 구현
    
    - ##### 2-2-5 하드웨어 장비의 예
      - 브리지
      - 스위치 
     
    - ##### 2-2-6. 정리
      - 같은 네트워크에 있는 여러 대의 컴퓨터들이 데이터를 주고받기 위해서 필요한 모듈
      - 전송단위는 `프레임`
      - Framing?  
        데이터 링크 계층에 속하는 작업 중 하나, `데이터의 앞 뒤에 특정한 비트열(MAC 주소 - 물리적주소 + a)을 붙이는 것`
      - `맥 주소를 가지고 통신` -> `맥 주소를 가지고 물리계층에서 받은 정보 전달`   
      - 물리계층을 통해 송수신되는 정보의 오류와 흐름을 관리하여 `안전한 정보의 전달을 수행할 수 있도록 도와주는 역할`
      - 안전한 정보의 전달(신뢰성 있는 전송)을 위해 `오류 제어`와 `흐름 제어` 필요
      - 오류 제어 - 에러를 감지하고 처리(검출하여 수정, 재전송)
      - 흐름 제어 - 송신자와 수신자의 처리 속도간의 차이를 해결하기 위한 제어, 수신 측이 `ACK`(잘 받았다는 메세지)를 통해 제어

  - #### 2-3. 네트워크 계층(Network Layer)
    - ##### 2-3-1. 더 많은 컴퓨터들 사이의 통신  
      ![image](https://user-images.githubusercontent.com/65080004/116181645-ef132480-a755-11eb-86d1-2d4d426bf7bf.png)  
      - 현재 A가 B에게 데이터를 보내려함
      
      - A는 인코딩을 통해 데이터 앞에 출발지, 목적지 IP주소(IP - 각 컴퓨터들이 갖는 `고유한 주소` / 논리적 주소)를 붙임  
        이것을 `패킷`이라고 함
     
      - A는 설정된 라우터 IP(기본 게이트웨이)를 통해 가에게 패킷을 전달
      
      - 라우터 가는 패킷을 열어 목적지 IP 주소를 라우팅테이블과 비교 후 패킷을 포장하여 다음 라우터 마에 전달  
        이러한 과정을 `라우팅`(목적지 IP 주소까지 어떤 경로로 데이터를 보낼지 결정하는 것)이라고 함  
        
        참고!  
        라우터는 라우팅을 위해 목적지 ip주소와 목적지로 가기 위한 바로 다음 라우터 주소를 저장한 `라우팅 테이블`을 가지고 있음  
        
      - 라우터 마는 라우팅을 통해 라우터 바에게 전달하고, 바도 마와 같이 라우터 라에게 전달
      
      - 라우터 라는 목적지 IP 주소를 확인하여, B에게 데이터 전달
    
    - ##### 2-3-2. 인코딩/디코딩
      - 과정
        ```
        1. 데이터를 송신하려는 컴퓨터에서 데이터를 수신 컴퓨터로 보내려함

        2. 네트워크 링크 계층 인코더에서 데이터에 출발지, 목적지 IP가 붙어서 패킷화 되어 나옴
        
        3. 패킷이 된 데이터는 데이터 링크 계층 인코더에서 Framing 되어 나옴
        
        4. Framing이 된 데이터는 물리 계층 인코더에서 아날로그 신호로 변환
        
        5. 라우터에 도착하여 1~3계층 디코더를 통해 해석 된 후 목적지가 맞는지 확인
        
        6. 아닐경우 다시 3~1 계층 순서로 인코딩을 통해 아날로그 신호로 변환
        
        7. 목적지가 맞을 경우 디코더를 통해 해석되어 데이터가 전달 됨
        ```
        
    - ##### 2-3-3. 기술 구현 위치
      - 운영체제의 커널에
      - 소프트웨어 적으로 구현
    
    - ##### 2-3-4. 장비의 예
      - 브리지
      - L3 스위치(스위치 + 라우팅 기능) 
    
    - ##### 2-3-5. 정리
      - 수많은 네트워크들의 연결로 이루어지는 inter-network 속에서 
      - 어딘가에 있는 `목적지 컴퓨터로 데이터를 전송`하기 위해,  
        `IP 주소`를 이용하여 길을 찾고(`routing`) 자신 다음의 라우터에게 데이터를 넘겨주는 것(`forwarding`)
      - 즉, `네트워크간의 통신이 가능하도록 경로를 설정하고, 경로를 따라 패킷을 전달해주는 역할`
      - 전송단위는 `패킷`

### 3. Reference
  - [우아한Tech OSI 7 Layer](https://www.youtube.com/watch?v=1pfTxp25MA8&t=2043s)  
  - [Tech Interview OSI 7 Layer](https://gyoogle.dev/blog/computer-science/network/OSI%207%EA%B3%84%EC%B8%B5.html)  
  - [effortDev OSI 7 Layer](https://shlee0882.tistory.com/110)  
  - [위키백과 OSI 모형](https://ko.wikipedia.org/wiki/OSI_%EB%AA%A8%ED%98%95)  
  - [개발일지 네트워크 계층](https://soft-dino.tistory.com/18)  
  - [어떤 프로그래머 OSI7 Layer](https://popcorntree.tistory.com/107?category=863736)  
  - [sjparkk.log 네트워크 계층](https://velog.io/@gndan4/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B3%84%EC%B8%B5)  
