# Git CLI
## 목차
  1. [버전관리의 시작](#1-버전관리의-시작)  
  1-1. [저장소 만드는 법](#1-1-저장소-만드는-법)  
  1-2. [명령어](#1-2-명령어)  
  2. [버전의 생성](#2-버전의-생성)  
  2-1. [버전 만들어보기](#2-1-버전-만들어보기)   
  2-2. [여러개의 파일을 버전으로 만들기](#2-2-여러개의-파일을-버전으로-만들기)  
  2-3. [명령어](#2-3-명령어)  
  3. [버전간의 차이점 비교](#3-버전간의-차이점-비교)  
  3-1. [버전관리의 효용](#3-1-버전관리의-효용)  
  3-2. [명령어](#3-2-명령어)  
  4. [checkout과 시간 여행](#4-checkout과-시간-여행)  
  4-1. [checkout](#4-1-checkout)  
  4-2. [명령어](#4-2-명령어)  
  5. [보충수업](#5-보충수업)  
  5-1. [사소하지만 모르면 불편한 명령어](#5-1-사소하지만-모르면-불편한-명령어)  
  6. [버전 삭제](#6-버전-삭제)  
  6-1. [버전을 삭제하는 방법](#6-1-버전을-삭제하는-방법)  
  6-2. [명령어](#6-2-명령어)  
  7. [버전 되돌리기](#7-버전-되돌리기)  
  7-1. [버전을 되돌리는 방법](#7-1-버전을-되돌리는-방법)  
  7-2. [명령어](#7-2-명령어)  
***
### 1. 버전관리의 시작
  - #### 1-1. 저장소 만드는 법
    1. 원하는 디렉토리 위치에 폴더 생성  
        - 순서  
        pwd → cd → mkdir  
        
    2. 폴더 내부로 이동하여 git init을 통해 버전관리 시작 요청  
        - 순서  
        cd → git init .  
        
    3. 폴더 내부에 .git 폴더 생성 확인  
        - 순서  
        ls -al  
        - 절대로 .git 디렉토리를 지우면 안됨!!  
  
  - #### 1-2. 명령어  
    * pwd 
      ```
      현재 위치를 보여주는 명령어
      Ex) pwd  
      /c/Users/.../foldername
      ```
    * cd [이동할 디렉토리]
      ```
      디렉토리로 위치로 이동하게 해주는 명령어
      Ex) cd j:
      J 드라이브로 이동 후 pwd 입력 시 아래와 같이 나옴
      → /j
      
      상위 디렉토리로 이동
      Ex) cd ..
      ```
    * mkdir [폴더명]
      ```
      현재 위치에서 폴더를 생성해주는 명령어
      Ex) mkdir test → test라는 이름을 가진 폴더 생성
      ```
    * ls -al
      ```
      현재 디렉토리의 목록을 보여주는 명령어
      -al이라는 옵션은 모든 목록을 의미
      ```
    * git init 
      ```
      버전관리를 시작해달라는 명령어
      init - Initialize 초기화의 약자
      (공백). → 현재 디렉토리를 의미
      Ex) git init .
      ```
### 2. 버전의 생성
  - #### 2-1. 버전 만들어보기  
    <p align="center"><img src="/img/Git/git_3step.png" width="70%" height="60%" title="Git 3단계 이미지"></img></p>  
      
    1. Working tree(Working Directory)  
        - 만들고 수정한 파일들이 있는 곳  
          즉, 아직 버전으로 만들어지기 전 단계  
      
    2. Staging Area(Index)  
        - 버전을 만들려고 할 때 버전으로 만들고 싶은 파일을 올리는 곳  
        - Working tree 와 Repository 사이에 존재하는 공간
    
    3. Repository(.git directory)  
        - 만들어진 버전이 저장되는 곳  
        - .git 디렉토리를 repository로 봐도 무방함  
  
  - #### 2-2. 여러개의 파일을 버전으로 만들기
    - hello1.txt를 수정, hello2.txt 생성 했을때 어떤 일이 발생하는가?
        1. git status 명령어 실행  
          
        3. 기존에 있던 파일을 수정한 hello1.txt는 Changes not staged for commit  
           즉, 관리하고 있지만 스테이지 위에 올라가 있지 않음  
          
        3. 새로만든 hello2.txt는 untracked files   
           즉, 없는 상태로 봄 또한 스테이지 위에 올라가 있지 않음  
           
    - 결론  
      ```
      git은 모든 파일을 자동으로 추적 관리 하지 않는다.  
      백업 또는 협업 하고 싶지 않은 파일은 Untracked 상태로 두면 됨  
      관리를 하고 싶을 경우 git에게 알려줘야한다. (git add 명령어 사용) 
      ```
    - 각각의 버전마다 어떤 파일이 있는지 확인하고 싶은 경우?  
        git log --stat 명령어를 사용하면 됨
    
  - #### 2-3. 명령어
    * nano [파일명]
      ```
      기본 에디터인 nano를 사용하여 파일을 생성하는 명령어
      
      작성 순서
      1. 작성하고자 하는 내용을 적음
      2. 에디터 나가기 : ^X → Ctrl + X
         에디터 하단에 다 적혀 있음
      3. 나가기를 누르면 저장할 것인지 묻는 메세지 나옴
      4. 파일 이름 확인 후 엔터 입력하면 파일 만들어짐
      
      참고
      git config --global core.editor "vim"
      ↑ 편집에디터를 nano에서 vim으로 변경하는 명령어
      ```
    * git status
      ```
      working tree status
      현재 상태가 어떤지 보는 명령어
      
      commits(버전이 있는지), Untracked files(추적되지 않는 파일), 
      Changes to be committed(버전이 되기 위해 올라온 파일목록), .. 등의 상태 출력
      ```
    * git add [파일명]
      ```
      add to staging area
      이 파일을 버전으로 만들기 위해 스테이징에 추가하는 명령어
      버전관리가 되고 있는 파일, 아닌 파일 상관없이 stage에 올리기 위해 사용
      ```
    * git commit
      ```
      create version
      버전을 만드는 명령어
     
      참고
      git commit만 작성할 경우 에디터가 나오고 수정이 가능하지만 
      git commit -m "커밋내용"를 사용할 경우 에디터를 거치지 않고 바로 버전생성
      ```
    * git log
      ```
      show version
      버전들에 대한 로그(역사, 설명)를 보는 명령어
      작성자, 작성일자, 버전의 고유 아이디 값 등을 보여줌
      
      --stat 옵션
      git log --stat
      각 버전별 연관된 파일과 추가된 라인(줄), 추가된 파일을 알 수 있음
      ```
### 3. 버전간의 차이점 비교
  - #### 3-1. 버전관리의 효용  
    * 결론
      ```
      버전과 버전간, 파일과 파일간 차이점을 비교함으로써  
      어디에서 문제가 생겼는지 추적하는데 도움이 됨. 
      또한 비교를 통해 어떠한 의사결정을 내릴 수 있음  
      ```
  - #### 3-2. 명령어
    * git diff
      ```
      show changes, diff → difference의 약자
      마지막 버전과 워킹트리에서 만들어진 버전간 차이점을 보여주는 명령어
      
      마지막 버전 이후에 어떠한 작업을 했는지 보여주며
      이를 통해 버전을 만들기 전 최종적으로 검토 할 수 있도록 해준다.
      
      추가된 코드는 + / 삭제된 코드는 - 로 나타냄 
      ```
    * git reset --hard
      ```
      워킹 트리에서 작업한 모든 내용을 삭제해주는 명령어
      
      마지막 버전 상태로 돌아가게됨
      
      참고
      --hard 뒤에 특정 버전의 commit_id 입력시 특정 버전으로 리셋, 특정 버전 이후 버전은 다 삭제됨
      ```
    * git log -p
      ```
      버전 별 추가되거나 삭제된 문서, 추가된 코드와 삭제된 코드를 볼 수 있는 명령어
      
      각 commit의 diff결과를 줄 단위로 보여줌
      ```
### 4. checkout과 시간 여행
  - #### 4-1. checkout
    * 버전관리란?  
      ```
      코드, 파일 또는 문서를 수정할 때마다 의미있는 변경점을 기록하는 것  
      ```  
    * 변경점 기록의 효용은 무엇인가?  
      ```
      과거, 미래 등 시간을 탐색할 수 있다는 점이다.
      ```
    * 시간을 탐색하고 싶다면 어떻게 해야하는가?
      ```
      참고
      최신 버전은 master(실제 마지막 버전, 현재는 이렇게 밖에 설명 할 수 없다.)
      
      1. 최신 버전 이전의 파일로 돌아가고 싶은 경우(과거로의 여행)
        - git log 명령어를 사용하여 돌아가고 싶은 커밋 아이디를 카피
        - git checkout (카피한 커밋 아이디)
        - 커밋 아이디를 만든 시점으로 돌아가게 된다. (HEAD를 커밋 아이디 시점으로 옮긴다.)
        - 주의! 마스터가 가리키는 최신버전은 지워진것은 아님 안보일뿐
      
      2. 이전의 파일 상태에서 최신 버전으로 돌아가고 싶은 경우
        - git checkout master
        - 가장 최신이었던 상태로 돌아가게 된다. (즉, master가 가리키는 최신버전으로 돌아간다.)
      ```
  - #### 4-2. 명령어
    * git checkout  
      ```
      git checkout [커밋 아이디]
      해당 커밋 아이디를 만든 시점으로 돌아가게 됨
      git checkout master
      가장 최신이었던 상태로 돌아가게 됨
      ```
### 5. 보충수업
  - #### 5-1. 사소하지만 모르면 불편한 명령어
    * 지금까지 사용한 방법  
      ```
      1. nano hello1.txt
         → nano text editor를 사용하여 해당 파일을 만들거나 수정
      
      2. git add hello1.txt
         → working directory에서 작업한 파일을 버전으로 만들기 위해 staging area에 추가
      
      3. git commit -m "3"
         → 3이라는 이름을 가진 버전으로 만듦
      ```
      
    * 팁
      ```
      1. git add .을 사용
         → 현재 directory에 밑에 있는 모든 파일을 staging area에 추가하는 명령어
         즉, add를 파일명 하나하나 지정할 필요가 없음
      
      2. git commit -am "메세지" 를 사용
         →  add와 commit을 한번에 할 수 있음
         
         참고
         -a : add의 약자로 add 옵션
         -m : 커맨드 라인에서 Message를 입력하겠다는 옵션
         
         주의사항
         
         새롭게 추가된 파일(Untracked files)은 자동으로 추가되지 않음
         
         최초 한번은 add가 되어서 tracked 상태가 되어야지만 자동으로 추가해준다. 
         
         즉, 위 주의사항을 통해서 
         추적하고 싶지 않은 파일을 실수로 추적하는 사고를 미연에 방지할 수 있다는 것을 알 수 있음.
      
      3. git commit 명령어만 실행할 경우
         → 기본 text editor(vi editor)가 실행됨, 여러줄의 커밋 메세지를 좀 더 편리하게 작성 가능
         
         참고 
         vi editor → vim editor(vi에서 기능이 확장된 것, 본질적으로 같은 에디터)
         
         명령 모드 
          - 실행시 기본적인 모드
         
         입력 모드 변경 
          - i or a or o 키입력을 통해 진입, esc 입력시 명령 모드로 전환
         ex 명령 모드 변경
          - : 입력을 통해 ex 명령 모드로 전환
         종료
          - :wq → 저장과 동시에 편집기 종료
          - :q! → 저장하지 않고 편집기 종료
         
         커밋 작성시 참고
          - 저장하지 않고 편집기 종료시 커밋 작성 안됨!
          - 커밋 메시지가 없으면 저장하였어도 커밋 작성 안됨!
          - 커밋 메세지 내 #으로 시작하는 줄은 주석처리, 커밋 메세지로 저장되지 않음.
         
         기본 에디터 변경하기
         git config --global core.editor "vim"
         
         --global : 로그인한 사용자 전체의 범위
         core.editor "vim(or 에디터의 경로를 넣어줘도 됨)"
      ```
### 6. 버전 삭제
  - #### 6-1. 버전을 삭제하는 방법
    * 버전을 삭제할때는 어떻게 하는가?
      ```
      1. git log를 통해 현재 어떤 상태인지 확인
      
      2. 만약 Message 3를 지우고 Message 2 버전으로 리셋을 해야한다.
        
        * 이 버전으로 리셋을 한다는 것은 이 버전이 되겠다 라는 뜻! (매우 중요!)
        
        * git reset --hard (commit id)를 사용하여 진행 
      ```
  - #### 6-2. 명령어
    * git reset
      ```
      git reset --hard (commit id)
      → 버전 뿐만아니라 수정하고 있는 것까지도 지움 즉, 가장 강력하게 지우는 것
      
      그럼, 버전만 지우고 수정하고 있는 것은 남겨두고 싶은 경우는 어떻게?
      git reset --soft or --mixed 를 사용
      
      현재는 이정도까지만 파악하고 넘어가기(현재 수준에서는 매우 복잡하므로..)
      
      주의사항
      협업을 하고 있을때 다른사람과 공유된 버전은 reset을 사용할 경우 엉킴
      따라서, 공유되지 않은 버전에 reset을 사용해야 한다. 
      ```
### 7. 버전 되돌리기
  - #### 7-1. 버전을 되돌리는 방법
    *  버전을 되돌때는 어떻게 하는가?
      ```
      revert 삭제의 목적과 보존의 목적을 동시에 달성 가능!
      
      돌아가고자 하는 버전의 이후 버전의 커밋 아이디를 입력해야함
      Ex) 마지막 버전 commit id c4, 돌아가고자 하는 버전 c3로 가정
          1. git revert c4
          
          2. text editor 실행, revert에 대한 커밋 메세지 입력되어있음
             추가적으로 설명하고자 하는 내용 추가 가능        
          
          3. git log 출력해보면
          
          4. 기존 버전들은 남아 있고, revert에 대한 커밋이 헤더에 추가된 것을 확인할 수 있음
             즉, 기존의 커밋은 내버려 두고 이 커밋에서의 변화를 취소한 것
          
          5. git log -p를 사용해서 보면 해당 파일 내용들이 c3 버전으로 돌아간 것을 확인 할 수 있음
      ```
  - #### 7-2. 명령어
    * git revert
      ```
      git revert (commit id)
      → 기존의 커밋은 내버려 두고 해당 커밋의 변화를 취소하는 명령어 
      
      그럼, 최초의 버전으로 돌아가고 싶은 경우는 어떻게 해야하는가?
      
      반드시 역순으로 revert를 사용해야한다.
      Ex) 최초의 버전 commit id를 c1으로, 마지막 commit id c3 가정
          1. git revert c3
          2. git revert c2
          
      왜 이렇게 사용해야 하는가?
      
      충돌이 일어나기 때문에(처리하기 매우 까다로움!!)
      Ex) 최초의 버전 commit id를 c1으로, 마지막 commit id c3 가정
          1. git revert c2 (c1의 이후 버전이므로)
          2. c2에 해당하는 변화는 모두 사라짐
          3. 그러나 c3 커밋에서의 변화는 남아있으므로 충돌 발생!
      
      현재는 이정도까지만 파악하고 넘어가기(현재 수준에서는 매우 복잡하므로..)
      ```
## Reference   
  - [생활코딩 GIT CLI](https://opentutorials.org/course/3839/22591)
  - [ian의 개발일기장](https://ian90.tistory.com/82) 
***
[목차로 이동](https://github.com/youngho-j/TIL/blob/main/Git/README.md "Go README.md")
